{"componentChunkName":"component---src-templates-post-template-js","path":"/2017/08/phan-lop-van-ban.html","result":{"data":{"markdownRemark":{"id":"42324d40-86d5-5af9-a15b-4e5ab3b73bfa","html":"<p>Trong Machine Learning và NLP, phân lớp văn bản là một bài toán xử lí văn bản cổ điển, gán các nhãn phân loại lên một văn bản mới dựa trên mức độ tương tự của văn bản đó so với các văn bản đã được gán nhãn trong tập huấn luyện.  </p>\n<p>Các ứng dụng của phân lớp văn bản thường rất đa dạng như: <em>lọc email spam, phân tích cảm xúc (sentiment analysis), phân loại tin tức, …</em>  </p>\n<p>Sau mình sẽ giới thiệu vài nét rất tổng quát các bước để có thể phân lớp văn bản, một số kỹ thuật thường sử dụng, các thư viện, đưa ra từ khóa để tự tìm hiểu thêm và chi tiết ở các bài viết khác.  </p>\n<p>Note: Đối tượng bài viết những ai đang tìm hiểu về NLP và Machine Learning. Mình sử dụng Python và R. Những điều mình viết có thể không được chính xác 100%, vậy những ai chuyên gia trong lĩnh vực này có thể giúp mình correct bài viết nhé.  </p>\n<h2 id=\"quy-trình-tổng-quát\" style=\"position:relative;\"><a href=\"#quy-tr%C3%ACnh-t%E1%BB%95ng-qu%C3%A1t\" aria-label=\"quy trình tổng quát permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Quy trình tổng quát</h2>\n<p>Việc phân lớp về cơ bản có thể có nhiều kỹ thuật, tổng quát đều thực hiện các bước sau:  </p>\n<ul>\n<li><strong>Tiền xử lý văn bản:</strong> lọc bỏ dấu câu, chính tả, kỹ tự lỗi, …</li>\n<li><strong>Biểu diễn văn bản</strong> dưới dạng <strong>vector</strong> (thường gọi là mô hình hóa văn bản, vector hóa văn bản), thường phải làm các công việc như sau:</li>\n<li>Tách từ (tokenizer, n-gram, …; tiếng việt có thư viện <a href=\"http://mim.hus.vnu.edu.vn/phuonglh/softwares/vnTokenizer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">vnTokenizer</a> khá nổi tiếng), lọc bỏ stopwords (những từ xuất hiện nhiều nhưng không mang nhiều ý nghĩa (<em>a, the, in, of, …; thì, là, nên, …</em>).</li>\n<li>Vector hóa văn bản (feature vector): sử dụng các kỹ thuật như <a href=\"https://en.wikipedia.org/wiki/Bag-of-words_model\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Bag of Words</a>, <a href=\"https://en.wikipedia.org/wiki/Tf%E2%80%93idf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">TF-IDF</a>, …<br>\nSố chiều của vector này bằng số từ được token (có thể lên tới 100.000 hay 10.000.00 chiều), đây của là một problem của feature vector, để giải quyết có thể sử dụng các kỹ thuật PCA, SVD, …</li>\n<li><strong>Phân lớp văn bản sau</strong> sau khi văn bản được vector hóa, bước này ta chọn một mô hình, thuật toán ML phân lớp (<a href=\"http://scikit-learn.org/stable/modules/svm.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SVM</a>, <a href=\"https://github.com/dennybritz/cnn-text-classification-tf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CNN text classifier</a>, <a href=\"http://scikit-learn.org/stable/modules/naive_bayes.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Native-Bayes</a>, <a href=\"http://scikit-learn.org/stable/modules/tree.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Decision Trees</a>, <a href=\"http://scikit-learn.org/stable/modules/clustering.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">K-means</a>, <a href=\"http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.LatentDirichletAllocation.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">LDA - topic clustering</a>, …). Bước này bao gồm:</li>\n<li><strong>Train</strong> và <strong>Evaluate</strong> mô hình: chia dữ liệu thành 2 tập train và test để đánh giá mô hình. </li>\n<li>Thử, thay đổi mô hình, tham số và đánh giá, đến khi nào được kết quả tối ưu, gọi là m<em>odel selection</em>.</li>\n<li>Việc đánh giá mô hình có thể sử dụng: <a href=\"https://en.wikipedia.org/wiki/Receiver_operating_characteristic\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ROC Curve</a>, <a href=\"https://en.wikipedia.org/wiki/Precision_and_recall\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Precision/Recall</a>, <a href=\"https://en.wikipedia.org/wiki/Lift_(data_mining)\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Lift</a>, …</li>\n<li><strong>Deploy</strong>.</li>\n</ul>\n<h2 id=\"các-thư-viện-hỗ-trợ\" style=\"position:relative;\"><a href=\"#c%C3%A1c-th%C6%B0-vi%E1%BB%87n-h%E1%BB%97-tr%E1%BB%A3\" aria-label=\"các thư viện hỗ trợ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Các thư viện hỗ trợ</h2>\n<p>Với mình, việc hỗ trợ xử lý văn bản của <strong>Python</strong> rất mạnh, cú pháp dễ học nhiều thư viện và thuật toán cho NLP, Machine learning:</p>\n<ul>\n<li><strong>NLTK</strong>: Natural Language Toolkit (<a href=\"http://www.nltk.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://www.nltk.org</a>).<br>\n<a href=\"https://3.bp.blogspot.com/-_i6Le_EX3oU/WX_10OCZ9lI/AAAAAAAAmV8/X7JDtZf83DknCJbJrqdhbx1fXXzz0W8LgCK4BGAYYCw/s1600/tree.gif\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><img src=\"https://3.bp.blogspot.com/-_i6Le_EX3oU/WX_10OCZ9lI/AAAAAAAAmV8/X7JDtZf83DknCJbJrqdhbx1fXXzz0W8LgCK4BGAYYCw/s1600/tree.gif\"></a></li>\n<li><strong>SciPy</strong>: Python-based ecosystem of open-source software for mathematics, science, and engineering (<a href=\"https://www.scipy.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.scipy.org</a>).<br>\n<a href=\"https://4.bp.blogspot.com/-npda8VcLpTI/WX_2G0kAGzI/AAAAAAAAmWA/Pe52hgx3SBsD1rti-bnyVUPvSZcOjODJgCLcBGAs/s1600/Screenshot%2Bfrom%2B2017-08-01%2B10-31-24.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><img src=\"https://4.bp.blogspot.com/-npda8VcLpTI/WX_2G0kAGzI/AAAAAAAAmWA/Pe52hgx3SBsD1rti-bnyVUPvSZcOjODJgCLcBGAs/s1600/Screenshot%2Bfrom%2B2017-08-01%2B10-31-24.png\"></a></li>\n<li><strong>scikit-learn</strong>: Machine Learning in Python  (<a href=\"http://scikit-learn.org/stable/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://scikit-learn.org/stable/</a>)<br>\n<a href=\"https://1.bp.blogspot.com/-Qkv-KaOtQQI/WX_2lTj6E-I/AAAAAAAAmWI/VC7hvM9GlDYkFQaM8SnrqBc15phe8Sf0QCK4BGAYYCw/s1600/scikit-learn-logo.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><img src=\"https://1.bp.blogspot.com/-Qkv-KaOtQQI/WX_2lTj6E-I/AAAAAAAAmWI/VC7hvM9GlDYkFQaM8SnrqBc15phe8Sf0QCK4BGAYYCw/s320/scikit-learn-logo.png\"></a></li>\n<li><strong>Gensim</strong>: Topic modeling for human (<a href=\"https://radimrehurek.com/gensim/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://radimrehurek.com/gensim/</a>)<br>\n<a href=\"https://3.bp.blogspot.com/-Ted-CgUTbdQ/WX_2vm3DpqI/AAAAAAAAmWQ/9nQo0VipCloBhbHiiYI7CjtrzU33Hof2gCK4BGAYYCw/s1600/article_4_19_fig_1.jpg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><img src=\"https://3.bp.blogspot.com/-Ted-CgUTbdQ/WX_2vm3DpqI/AAAAAAAAmWQ/9nQo0VipCloBhbHiiYI7CjtrzU33Hof2gCK4BGAYYCw/s320/article_4_19_fig_1.jpg\"></a><br>\n(ảnh: <a href=\"https://ischool.syr.edu/infospace/2013/04/23/what-is-text-mining\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://ischool.syr.edu/infospace/2013/04/23/what-is-text-mining</a>)</li>\n<li><strong>Matplotlib</strong>: is a Python 2D plotting library (<a href=\"https://matplotlib.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://matplotlib.org</a>).<br>\n<a href=\"https://1.bp.blogspot.com/-FeOpj0O-4FE/WX_3Ja-k5kI/AAAAAAAAmWY/tSnGHC-VyKIa8XtmFezAyEQ21pTLbLuFgCLcBGAs/s1600/Screenshot%2Bfrom%2B2017-08-01%2B10-35-53.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><img src=\"https://1.bp.blogspot.com/-FeOpj0O-4FE/WX_3Ja-k5kI/AAAAAAAAmWY/tSnGHC-VyKIa8XtmFezAyEQ21pTLbLuFgCLcBGAs/s400/Screenshot%2Bfrom%2B2017-08-01%2B10-35-53.png\"></a></li>\n</ul>\n<p>Trên Python, bạn nên sử dụng <strong><a href=\"http://jupyter.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Jupyter Notebook</a></strong> để có thể code và visualize dễ dàng hơn. Các thư viện trên đều có thể cài dễ dàng bằng <strong>pip</strong>.</p>\n<h2 id=\"ví-dụ-phân-lớp-văn-bản-theo-category\" style=\"position:relative;\"><a href=\"#v%C3%AD-d%E1%BB%A5-ph%C3%A2n-l%E1%BB%9Bp-v%C4%83n-b%E1%BA%A3n-theo-category\" aria-label=\"ví dụ phân lớp văn bản theo category permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ví dụ: phân lớp văn bản theo category</h2>\n<p>Ở notebook ví dụ sau, với <a href=\"https://github.com/duyetdev/demo-text-classification/blob/master/data/newtrain.csv\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">data</a> là một đoạn text ngắn được phân thành 7 loại category khác nhau:</p>\n<p><img src=\"https://1.bp.blogspot.com/-Y7MMOQSN-Hc/WZ6387WQQLI/AAAAAAAAmuk/jGhk-DLhSqwQH97Uqjvwby-lZZxPKACowCLcBGAs/s1600/Screenshot%2Bfrom%2B2017-08-24%2B18-24-45.png\"></p>\n<p>Mình sẽ dùng kỹ thuật <strong>TF-IDF</strong> để biến văn bản thành một vector và sử dụng thuật toán <strong>SVM</strong> (<a href=\"http://scikit-learn.org/stable/modules/svm.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://scikit-learn.org/stable/modules/svm.html</a>) trong thư viện <strong>sklearn</strong> để tiến hành phân lớp.<br>\nSource: <a href=\"https://github.com/duyetdev/demo-text-classification/blob/master/classification-with-tfidf-svm.ipynb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/duyetdev/demo-text-classification/blob/master/classification-with-tfidf-svm.ipynb</a></p>\n<script src=\"https://gist.github.com/duyetdev/7c4cee01ecde476e246c6dfe55822fcb.js\"></script>","fields":{"slug":"/2017/08/phan-lop-van-ban.html","tagSlugs":["/tag/data-engineer/","/tag/gensim/","/tag/tutorial/","/tag/text-classification/","/tag/python/","/tag/javascript/","/tag/nlp/","/tag/nltk/","/tag/machine-learning/"]},"frontmatter":{"date":"2017-08-11T13:18:00.000+07:00","description":"Trong Machine Learning và NLP, phân lớp văn bản là một bài toán xử lí văn bản cổ điển, gán các nhãn phân loại lên một văn bản mới dựa trên mức độ tương tự của văn bản đó so với các văn bản đã được gán nhãn trong tập huấn luyện.","tags":["Data Engineer","Gensim","Tutorial","Text Classification","Python","javascript","NLP","NLTK","Machine Learning"],"title":"Phân lớp văn bản","fbCommentUrl":"http://blog.duyetdev.com/2017/08/phan-lop-van-ban.html"}}},"pageContext":{"slug":"/2017/08/phan-lop-van-ban.html"}}}