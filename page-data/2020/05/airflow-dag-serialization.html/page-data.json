{"componentChunkName":"component---src-templates-post-template-js","path":"/2020/05/airflow-dag-serialization.html","result":{"data":{"markdownRemark":{"id":"d5891262-a890-594d-92f2-1fb6452eee16","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f048eb6b229acf8b52b494065895537e/d004c/dag_serialization.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.9062693978895%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAACI0lEQVQoz3VRS2sTURS+Jj421l1/gBtBMFmIVEFwUcVQ0IUb6UJEYqsi2NqFm0qqiPYBrRhofKAupLizJMY2FpGiSU2NFJJJMpOZyZ3JPJJMnu0EmmRskh5vCkoQ/eDAued857vnfhfxy1dOFdcGxpv41qjKfx4VBPGBxHj7EcG7JdUcDi2Y2vns+GUk+u32zfjgwzoecwiYccgCNRn2u06gTmwyw1OwPQ5QvAetygoAKFDk3wQ6OXD0KXp2uttUY0doqN8H0J1g6BThJgEH7970+EK2lCgEk8nkBVQXJ8agSkE5E6rXuaGfIN6ALW7Qc9sJewP+L2eCwYDlt7ChvvLrhShU1AXDYAZqoA2BtnLu6nJQOV8qFVKSJF1H+MeUTWNevyzjuelc3DmjxZzPi/T0pffej4d1XQctmwm7D1p65g9ZjwlrT4bz3JyLvOBxJuqcydGzL1Z9jt72ZYosWl0u1z4Uo5N3eCy31HQhq2ZKmqwWazxW3xKOiWXZ3gRNWwJHjnctWk92MazoS8nZqpop5EVJ0yQlD5Eof/H76reearUKgiDYkCxLk8QM2Fgvw3q5BM3mFiiK9BX9A+m0EoPtFlT0DcjntPYY0HRshLT2JxIJOxHsRjzP9xMz/RzHfSAbeWia/kQajh3PDMPMsezOL18727eL1B9hjBfj8biXoqh5MrNEhPrQf7Cn80CE/+Rut/tv7gESuzsLjUbDHIlE0C+ehWX4iuQyMwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/f048eb6b229acf8b52b494065895537e/c85cb/dag_serialization.webp 300w,\n/static/f048eb6b229acf8b52b494065895537e/e88ff/dag_serialization.webp 600w,\n/static/f048eb6b229acf8b52b494065895537e/92f8c/dag_serialization.webp 1200w,\n/static/f048eb6b229acf8b52b494065895537e/6eb7d/dag_serialization.webp 1611w\"\n          sizes=\"(max-width: 1200px) 100vw, 1200px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/f048eb6b229acf8b52b494065895537e/5a46d/dag_serialization.png 300w,\n/static/f048eb6b229acf8b52b494065895537e/0a47e/dag_serialization.png 600w,\n/static/f048eb6b229acf8b52b494065895537e/c1b63/dag_serialization.png 1200w,\n/static/f048eb6b229acf8b52b494065895537e/d004c/dag_serialization.png 1611w\"\n          sizes=\"(max-width: 1200px) 100vw, 1200px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/f048eb6b229acf8b52b494065895537e/c1b63/dag_serialization.png\"\n          alt=\"dag serialization\"\n          title=\"dag serialization\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>From <a href=\"https://airflow.apache.org/docs/1.10.10/dag-serialization.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">the Airflow docs</a>: </p>\n<p>Without DAG Serialization &#x26; persistence in DB, the Webserver and the Scheduler both needs access to the DAG files. Both the scheduler and webserver parses the DAG files.</p>\n<p>With DAG Serialization we aim to decouple the webserver from DAG parsing which would make the Webserver very light-weight.</p>\n<p>The Webserver now instead of having to parse the DAG file again, reads the serialized DAGs in JSON, de-serializes them and create the DagBag and uses it to show in the UI.</p>\n<p>One of the key features that is implemented as the part of DAG Serialization is that instead of loading an entire DagBag when the WebServer starts we only load each DAG on demand from the Serialized Dag table. This helps reduce Webserver startup time and memory. The reduction is notable when you have large number of DAGs.</p>\n<h1 id=\"enable-dag-serialization\" style=\"position:relative;\"><a href=\"#enable-dag-serialization\" aria-label=\"enable dag serialization permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Enable Dag Serialization</h1>\n<p>Add the following settings in <code class=\"language-text\">airflow.cfg</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"ini\"><pre class=\"language-ini\"><code class=\"language-ini\"><span class=\"token selector\">[core]</span>\n<span class=\"token constant\">store_serialized_dags</span> <span class=\"token attr-value\"><span class=\"token punctuation\">=</span> True</span>\n<span class=\"token constant\">min_serialized_dag_update_interval</span> <span class=\"token attr-value\"><span class=\"token punctuation\">=</span> 30</span></code></pre></div>\n<p>If you are updating Airflow from &#x3C;1.10.7, please do not forget to run <code class=\"language-text\">airflow db upgrade</code>.</p>\n<h1 id=\"references\" style=\"position:relative;\"><a href=\"#references\" aria-label=\"references permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>References</h1>\n<ul>\n<li><a href=\"https://airflow.apache.org/docs/1.10.10/dag-serialization.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://airflow.apache.org/docs/1.10.10/dag-serialization.html</a></li>\n</ul>","fields":{"slug":"/2020/05/airflow-dag-serialization.html","tagSlugs":["/tag/data-engineer/","/tag/airflow/"]},"frontmatter":{"date":"2020-05-01T02:00:00.000+07:00","description":"In order to make Airflow Webserver stateless, Airflow >=1.10.7 supports DAG Serialization and DB Persistence.","tags":["Data Engineer","Airflow"],"title":"Airflow DAG Serialization","fbCommentUrl":"none"}}},"pageContext":{"slug":"/2020/05/airflow-dag-serialization.html"}}}