{"componentChunkName":"component---src-templates-post-template-js","path":"/2014/02/huong-dan-viet-game-flappy-bird-bang.html","result":{"data":{"markdownRemark":{"id":"c7f97021-57d6-567f-a745-8ba71a9bdb28","html":"<p>Flappy Bird của anh Đông Nguyễn hiện đang là 1 game khá hot tại thời điểm này, với top của 2 kho ứng dụng lớn nhất hiện nay. Nhưng do một số áp lực, Flappy Bird đã bị tháo khỏi 2 kho ứng dụng. Hôm nay mình sẽ hướng dẫn các bạn 1 số bước cơ bản để viết được 1 game flappy bird đơn giản cho riêng mình chỉ với 65 dòng code Javascript trên thư viện Phaser Framework.</p>\n<p>Bạn có thể test thử flappy bird siêu đơn giản <a href=\"https://jsfiddle.net/lvduit/rP5Kt/embedded/result/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">tại đây</a>.</p>\n<p><img src=\"https://1.bp.blogspot.com/-jDgau6eVkS4/UxF1Q_4cgoI/AAAAAAAAGW8/rrpNzbFGmUg/s1600/FB-1.png\"></p>\n<p>Yêu cầu: bạn phải biết 1 số javascript cơ bản, bởi tut này viết trên HTML5 Canvas và Javascript.\nPhaser frameword bạn có thể tìm hiểu trên Google và mình sẽ có 1 bài hướng dẫn trong các bài viết sau.</p>\n<h2 id=\"bước-1-cài-đặt\" style=\"position:relative;\"><a href=\"#b%C6%B0%E1%BB%9Bc-1-c%C3%A0i-%C4%91%E1%BA%B7t\" aria-label=\"bước 1 cài đặt permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bước 1: Cài đặt</h2>\n<p>Bạn nên <a href=\"https://github.com/lessmilk/phaser-tutorials/blob/master/2-flappy_bird/basic_template.zip?raw=true\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download template</a> cơ bản này để sử dụng trong hướng dẫn này. Download về giải nén, bạn sẽ có:</p>\n<ul>\n<li><code class=\"language-text\">phaser.min.js</code> bản nén của Phaser Frameword v1.1.5</li>\n<li><code class=\"language-text\">index.html</code>, game sẽ chạy trên file này</li>\n<li><code class=\"language-text\">main.js</code>, nơi chúng ta sẽ code cho flappy bird</li>\n<li>thư mục <code class=\"language-text\">asssets/</code>, chứa 1 số tài nguyên, mình đã để sẳn 2 file là <code class=\"language-text\">bird.png</code> và <code class=\"language-text\">pipe.png</code></li>\n</ul>\n<p>Đặt tất cả các file trên vào cùng 1 thư mục trong Web Server của bạn, bạn có thể upload lên hosting hoặc chạy local bằng XAMPP hoặc WAMPP.</p>\n<p>Mở file <code class=\"language-text\">index.html</code> trên trình duyệt.</p>\n<p>Mở file <code class=\"language-text\">main.js</code> bằng trình soạn thảo, như Notepad++, ở đây mình hay dùng Sublime Text.</p>\n<p>Bạn sẽ thấy trong file <code class=\"language-text\">main.js</code> một khung cơ bản của game. Cái này mình sẽ nói ở 1 bài viết về Phaser Framework.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Initialize Phaser, and creates a 400x490px game</span>\n<span class=\"token keyword\">var</span> game <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Phaser<span class=\"token punctuation\">.</span>Game</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">490</span><span class=\"token punctuation\">,</span> Phaser<span class=\"token punctuation\">.</span><span class=\"token constant\">AUTO</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'game_div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Creates a new 'main' state that will contain the game</span>\n<span class=\"token keyword\">var</span> main_state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token function-variable function\">preload</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Function called first to load all the assets</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token function-variable function\">create</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Fuction called after 'preload' to setup the game   </span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token function-variable function\">update</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Function called 60 times per second</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Add and start the 'main' state to start the game</span>\ngame<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">,</span> main_state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \ngame<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </code></pre></div>\n<p>Chúng ta sẽ sửa đổi hàm <code class=\"language-text\">preload()</code>, <code class=\"language-text\">create()</code> và <code class=\"language-text\">update()</code> và thêm 1 số hàm khác để game có thể hoạt động.</p>\n<h2 id=\"bước-2-con-trym\" style=\"position:relative;\"><a href=\"#b%C6%B0%E1%BB%9Bc-2-con-trym\" aria-label=\"bước 2 con trym permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bước 2: Con trym</h2>\n<p>Rồi bắt đầu code thôi nào. Trong tut này thì con chim của chúng ta chỉ có thể nhảy nhảy bằng phím <code class=\"language-text\">spacebar</code>. </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">preload</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n    <span class=\"token comment\">// Change the background color of the game</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>stage<span class=\"token punctuation\">.</span>backgroundColor <span class=\"token operator\">=</span> <span class=\"token string\">'#71c5cf'</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Load the bird sprite</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">image</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bird'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'assets/bird.png'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token function-variable function\">create</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n    <span class=\"token comment\">// Display the bird on the screen</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">sprite</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">245</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bird'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Add gravity to the bird to make it fall</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>gravity<span class=\"token punctuation\">.</span>y <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span> \n\n    <span class=\"token comment\">// Call the 'jump' function when the spacekey is hit</span>\n    <span class=\"token keyword\">var</span> space_key <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>input<span class=\"token punctuation\">.</span>keyboard<span class=\"token punctuation\">.</span><span class=\"token function\">addKey</span><span class=\"token punctuation\">(</span>Phaser<span class=\"token punctuation\">.</span>Keyboard<span class=\"token punctuation\">.</span><span class=\"token constant\">SPACEBAR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    space_key<span class=\"token punctuation\">.</span>onDown<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jump<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   \n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token function-variable function\">update</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n    <span class=\"token comment\">// If the bird is out of the world (too high or too low), call the 'restart_game' function</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird<span class=\"token punctuation\">.</span>inWorld <span class=\"token operator\">==</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">restart_game</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<ul>\n<li>Bắt đầu là hàm <code class=\"language-text\">preload()</code>, hàm <code class=\"language-text\">preload</code> sẽ cho chúng ta load hình ảnh khi trang được load, và sẽ gán cho nó 1 cái nickname </li>\n<li>Tiếp theo là hàm <code class=\"language-text\">create()</code>, khởi tạo game. <code class=\"language-text\">this.game.add.sprite(100, 245, &#39;bird&#39;);</code> sẽ thêm hình con chim tại tọa độ <code class=\"language-text\">(x, y) = (100, 245)</code></li>\n<li><code class=\"language-text\">this.bird.body.gravity.y = 1000;</code> sẽ làm cho chú chim của chúng ta rơi xuống theo trục <code class=\"language-text\">y</code></li>\n<li><code class=\"language-text\">space_key.onDown.add(this.jump, this);</code> khi nhấn thanh spacebar sẽ chạy hàm <code class=\"language-text\">jump()</code> làm cho chú chim nhảy lên. Chúng ta viết tiếp hàm <code class=\"language-text\">jump()</code> và hàm <code class=\"language-text\">restart_game()</code> bên dưới.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Make the bird jump</span>\n<span class=\"token function-variable function\">jump</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n    <span class=\"token comment\">// Add a vertical velocity to the bird</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>y <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">350</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token comment\">// Restart the game</span>\n<span class=\"token function-variable function\">restart_game</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n    <span class=\"token comment\">// Start the 'main' state, which restarts the game</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Chúng ta save file <code class=\"language-text\">main.js</code> lại, nhấn F5 file <code class=\"language-text\">index.html</code> trên trình duyệt và bạn đã thấy con chim của chúng ta.  Nhấn spacebar để nó nhảy nhảy.</p>\n<h2 id=\"bước-3-những-cái-ống-nước-khó-chịu\" style=\"position:relative;\"><a href=\"#b%C6%B0%E1%BB%9Bc-3-nh%E1%BB%AFng-c%C3%A1i-%E1%BB%91ng-n%C6%B0%E1%BB%9Bc-kh%C3%B3-ch%E1%BB%8Bu\" aria-label=\"bước 3 những cái ống nước khó chịu permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bước 3: Những cái ống nước khó chịu</h2>\n<p>Flappy Bird là phải có ống nước, vì thế chúng ta thêm hình ảnh những cái ống nước trong hàm preload()</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">image</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pipe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'assets/pipe.png'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </code></pre></div>\n<p>Sau đó, tạo 1 group các cái ống nước trong hàm <code class=\"language-text\">create()</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pipes <span class=\"token operator\">=</span> game<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">group</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   \n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pipes<span class=\"token punctuation\">.</span><span class=\"token function\">createMultiple</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pipe'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Bây giờ chúng ta sẽ tạo thêm 1 hàm mới, để có thể tạo các ống nước lần lượt xuất hiện trên màn hình. Nó trượt từ phải qua trái, nếu chú chim chạm vào ống nước thì game over, còn nếu k chạm thì các ống nước khi di chuyển đến biên trái sẽ bị ẩn đi.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">add_one_pipe</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token punctuation\">,</span> y</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n    <span class=\"token comment\">// Get the first dead pipe of our group</span>\n    <span class=\"token keyword\">var</span> pipe <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pipes<span class=\"token punctuation\">.</span><span class=\"token function\">getFirstDead</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Set the new position of the pipe</span>\n    pipe<span class=\"token punctuation\">.</span><span class=\"token function\">reset</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Add velocity to the pipe to make it move left</span>\n    pipe<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">200</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Kill the pipe when it's no longer visible</span>\n    pipe<span class=\"token punctuation\">.</span>outOfBoundsKill <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Hàm trên thì chỉ hiện ra 1 ống nước, nhưg chúng ta cần phải có 6 ống trên 1 hàng (6 khối) và 1 khối trống ở giữa (cái khe ấy)\nVì thế:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">add_row_of_pipes</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n    <span class=\"token keyword\">var</span> hole <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">!=</span> hole <span class=\"token operator\">&amp;&amp;</span> i <span class=\"token operator\">!=</span> hole <span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">add_one_pipe</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">,</span> i<span class=\"token operator\">*</span><span class=\"token number\">60</span><span class=\"token operator\">+</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Dĩ nhiên là những cái ống nước này sẽ chuyển động từ phải qua trái, cứ mỗi 1.5s sẽ xuất hiện thêm 1 ống nước. Vì thế chúng ta thêm dòng sau vào cuối hàm <code class=\"language-text\">create()</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timer <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span><span class=\"token function\">loop</span><span class=\"token punctuation\">(</span><span class=\"token number\">1500</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add_row_of_pipes<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p> Cuối cùng chúng ta thêm dòng này vào dòng đầu tiên của hàm <code class=\"language-text\">restart_game()</code> để dừng thời gian khi khởi động lại game.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Nào bây giờ bạn có thể F5 là xem thử rồi đó, nó vẫn chưa hoàn thiện nhưng dần dần đang giống game thật rồi haha.</p>\n<h2 id=\"bước-4-điểm-số-và-khi-chim-không-chui-được-vào-khe-\" style=\"position:relative;\"><a href=\"#b%C6%B0%E1%BB%9Bc-4-%C4%91i%E1%BB%83m-s%E1%BB%91-v%C3%A0-khi-chim-kh%C3%B4ng-chui-%C4%91%C6%B0%E1%BB%A3c-v%C3%A0o-khe-\" aria-label=\"bước 4 điểm số và khi chim không chui được vào khe  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bước 4: Điểm số và khi chim không chui được vào khe =]]</h2>\n<p>Điều cuối cùng là điểm trong game khi chim chạm vào cột. </p>\n<p>Chúng ta thêm những dòng sau vào hàm <code class=\"language-text\">create()</code> để hiển thị số điểm ở góc trên bên trái.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>score <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>   \n<span class=\"token keyword\">var</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> font<span class=\"token operator\">:</span> <span class=\"token string\">\"30px Arial\"</span><span class=\"token punctuation\">,</span> fill<span class=\"token operator\">:</span> <span class=\"token string\">\"#ffffff\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>label_score <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">,</span> style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p> Đặt 2 dòng sau và hàm <code class=\"language-text\">add_row_of_pipes()</code> để tăng 1 điểm mỗi khi xuất hiện thêm 1 cột mới.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>score <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>  \n\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>label_score<span class=\"token punctuation\">.</span>content <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Thêm dòng sau vào hàm <code class=\"language-text\">update()</code> để gọi hàm <code class=\"language-text\">restart_game()</code> mỗi khi chim chạm vào cột.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span><span class=\"token function\">overlap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pipes<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>restart_game<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Và xin chúc mừng, bạn đã hoàn thành game Flappy bird trên HTML5 (siêu siêu thô). Bạn có thể <a href=\"https://github.com/lessmilk/phaser-tutorials/blob/master/2-flappy_bird/flappy_bird.zip?raw=true\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download mã nguồn</a> của bài viết này tại đây</p>\n<h2 id=\"kì-tiếp-theo\" style=\"position:relative;\"><a href=\"#k%C3%AC-ti%E1%BA%BFp-theo\" aria-label=\"kì tiếp theo permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kì tiếp theo?</h2>\n<p> Chim đã bay, đã có thể chui vào khe.. Nhưng trông nó thật chán. Ở bài viết tiếp theo, mình sẽ hướng dẫn có bạn thêm âm thanh, hiệu ứng, menu, … Đón chờ next chap nhé. Chúc các bạn thành công.</p>\n<script type=\"text/javascript\">\n\tatOptions = {\n\t\t'key' : '02ffbb6986d37ce345726941bb6e214f',\n\t\t'format' : 'iframe',\n\t\t'height' : 50,\n\t\t'width' : 320,\n\t\t'params' : {}\n\t};\n\tdocument.write('<scr' + 'ipt type=\"text/javascript\" src=\"http' + (location.protocol === 'https:' ? 's' : '') + '://www.bcloudhost.com/02ffbb6986d37ce345726941bb6e214f/invoke.js\"></scr' + 'ipt>');\n</script>","fields":{"slug":"/2014/02/huong-dan-viet-game-flappy-bird-bang.html","tagSlugs":["/tag/javascript/","/tag/game/","/tag/html-5/","/tag/tuts/"]},"frontmatter":{"date":"2014-03-01T13:27:00.000+07:00","description":"Flappy Bird của anh Đông Nguyễn hiện đang là 1 game khá hot tại thời điểm này, với top của 2 kho ứng dụng lớn nhất hiện nay. Nhưng do một số áp lực, Flappy Bird đã bị tháo khỏi 2 kho ứng dụng. Hôm nay mình sẽ hướng dẫn các bạn 1 số bước cơ bản để viết được 1 game flappy bird đơn giản cho riêng mình chỉ với 65 dòng code Javascript trên thư viện Phaser Framework.","tags":["javascript","game","html5","tuts"],"title":"Hướng dẫn viết game Flappy Bird bằng HTML5 - Phần 1","fbCommentUrl":null}}},"pageContext":{"slug":"/2014/02/huong-dan-viet-game-flappy-bird-bang.html"}}}