{"componentChunkName":"component---src-templates-post-template-tsx","path":"/2014/03/huong-dan-viet-game-flappy-bird-bang.html","result":{"data":{"markdownRemark":{"id":"ff6bfff2-729c-568e-b3a0-5b278645b0f1","html":"<p>Trong phần 1 của chuỗi bài viết về cách viết 1 game Flappy Bird Clone, chúng ta đã làm được 1 bộ khung tương đối đơn giản, nhưng nó vẫn còn thiếu nhiều thứ. Trong phần 2 này chúng ta sẽ tìm hiểu cách thêm các hiệu ứng cho chú chim của chúng ta thêm phần ức chế.\nBạn có thể chơi thử trước tại đây để xem những gì chúng ta sẽ code trong phần 2 này, <a href=\"https://jsfiddle.net/lvduit/LeAj6/embedded/result/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">tại đây</a>.</p>\n<p><img src=\"https://4.bp.blogspot.com/-Eq0_6IHymko/UxmaVz4MU5I/AAAAAAAAGZE/DMmKGg7quvc/s1600/Untitled.png\"></p>\n<h2 id=\"bước-1-cài-đặt\" style=\"position:relative;\"><a href=\"#b%C6%B0%E1%BB%9Bc-1-c%C3%A0i-%C4%91%E1%BA%B7t\" aria-label=\"bước 1 cài đặt permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bước 1: Cài đặt</h2>\n<p>Đầu tiên bạn <a href=\"https://github.com/lessmilk/phaser-tutorials/raw/master/3-flappy_bird/flappy_bird_basic.zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download template</a> mình viết sẵn tại đây, trong file download về sẽ bao gồm chúng ta sẽ thực hiện trong phần 1, chỉ thêm 1 file mới là file audio.\nMở file main.js và bắt đầu nào.</p>\n<h2 id=\"bước-2-hiệu-ứng-bay\" style=\"position:relative;\"><a href=\"#b%C6%B0%E1%BB%9Bc-2-hi%E1%BB%87u-%E1%BB%A9ng-bay\" aria-label=\"bước 2 hiệu ứng bay permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bước 2: Hiệu ứng bay</h2>\n<p>Con chim của chúng ta chỉ bay lên và rơi xuống, như vậy thì sẽ rất chán, bây giờ mình sẽ hướng dẫn các bạn thêm 1 số hiệu ứng giống như game gốc của chúng ta. </p>\n<ol>\n<li>Khi rơi xuống chú chim sẽ úp mặt xuống.</li>\n<li>Khi bay lên ngẩng mặt lên.</li>\n</ol>\n<p>Đầu tiên chúng ta thêm dòng sau vào hàm update()</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird<span class=\"token punctuation\">.</span>angle <span class=\"token operator\">&lt;</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span>  \n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird<span class=\"token punctuation\">.</span>angle <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Thuộc tính angle cho phép chúng ta xoay đối tượng. Ở đây chúng ta sẽ thêm <code class=\"language-text\">this.bird.angle = -20;</code> vào hàm <code class=\"language-text\">jump()</code> để cho chú chim xoay lại như cũ khi nhảy lên. Tuy nhiên thuộc tính sẽ xoay 1 cách ngay lập tức, trông game như đang giật giật. Vì thế chúng ta sẽ k dùng cái này, thay vào đó sẽ sử dụng animate để cho chú chim “quay đầu” 1 cách mượt mà.  </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// create an animation on the bird</span>\n<span class=\"token keyword\">var</span> animation <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Set the animation to change the angle of the sprite to -20° in 100 milliseconds</span>\nanimation<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>angle<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">20</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// And start the animation</span>\nanimation<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </code></pre></div>\n<p>Hoặc bạn cũng có thể viết 1 cách ngắn gọn những dòng trên bằng 1 dòng đơn giản sau theo cú pháp của Javascript</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>angle<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">20</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Nếu bạn test thử game ngay bây giờ, bạn sẽ thấy nó sẽ quay không giống như game gốc, bởi thực ra nó được quay 1 góc với tâm ở cạnh trên bên trái. Bạn xem hình dưới để phân biệt.</p>\n<p><img src=\"https://3.bp.blogspot.com/-y_pto-d-ILM/UxmQL1Qn5MI/AAAAAAAAGY0/c2qGR5x3LUw/s1600/anchor.png\"></p>\n<p>Bên trái là code hiện tại của chúng ta, chú chim quay với tâm cố định cạnh bên. Cái chúng ta cần là nó quay với tâm như hình bên phải.</p>\n<p>Cái chúng ta cần là thay đổi tâm vào chính giữa, cái tâm đó gọi là “anchor”. Thêm dòng sau vào hàm create()</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird<span class=\"token punctuation\">.</span>anchor<span class=\"token punctuation\">.</span><span class=\"token function\">setTo</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </code></pre></div>\n<p>Xem thử nào, tốt hơn rồi đó =]]  </p>\n<h2 id=\"bước-3-chuyện-gì-xảy-ra-khi-chim-va-vào-cột\" style=\"position:relative;\"><a href=\"#b%C6%B0%E1%BB%9Bc-3-chuy%E1%BB%87n-g%C3%AC-x%E1%BA%A3y-ra-khi-chim-va-v%C3%A0o-c%E1%BB%99t\" aria-label=\"bước 3 chuyện gì xảy ra khi chim va vào cột permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bước 3: Chuyện gì xảy ra khi chim va vào cột.</h2>\n<p>Ở thời điểm này, khi chim của chúng ta chết nếu va vào cột và restart game ngay lập tức. Tiếp tục chúng ta sẽ chỉnh sửa 1 chút, khi chim chết trên màn hình hiện lên thông báo là bạn đã Fail.</p>\n<p>Chúng ta sẽ sửa dòng sau trong hàm <code class=\"language-text\">update()</code>, khi chim va vào cột sẽ không gọi <code class=\"language-text\">restart_game()</code> mà sẽ gọi <code class=\"language-text\">hit_pipe()</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span><span class=\"token function\">overlap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pipes<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>hit_pipe<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </code></pre></div>\n<p>Tiếp theo chúng ta sẽ viết thêm hàm <code class=\"language-text\">hit_pipe()</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">hit_pipe</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token comment\">// Set the alive property of the bird to false</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird<span class=\"token punctuation\">.</span>alive <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Prevent new pipes from appearing</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Go through all the pipes, and stop their movement</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pipes<span class=\"token punctuation\">.</span><span class=\"token function\">forEachAlive</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        p<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Cuối cùng, chúng ta sẽ không cho chú chim tiếp tục nhảy nếu như chim chết, sửa hàm <code class=\"language-text\">jump()</code> lại, return <code class=\"language-text\">false</code> nếu chim đã chết</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bird<span class=\"token punctuation\">.</span>alive <span class=\"token operator\">==</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>  \n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> </code></pre></div>\n<h2 id=\"bước-4-thêm-hiệu-ứng-âm-thanh\" style=\"position:relative;\"><a href=\"#b%C6%B0%E1%BB%9Bc-4-th%C3%AAm-hi%E1%BB%87u-%E1%BB%A9ng-%C3%A2m-thanh\" aria-label=\"bước 4 thêm hiệu ứng âm thanh permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bước 4: Thêm hiệu ứng âm thanh</h2>\n<p>Thêm âm thanh vào game ư? Cực kì dễ trong Phaser.</p>\n<p>Đầu tiên load nguồn trong <code class=\"language-text\">preload()</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">audio</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jump'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'assets/jump.wav'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Tiếp theo, khi nhảy lên thì phát ra âm thanh, thêm code sau vào hàm <code class=\"language-text\">create()</code> để khởi tạo biến jump_sound để lưu audio</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jump_sound <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">audio</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jump'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </code></pre></div>\n<p>Thêm dòng sau để phát ra âm thanh vào trong hàm jump()</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jump_sound<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </code></pre></div>\n<p>Và chúng ta đã làm xong phần 2, bạn có thể download source code của phần này <a href=\"https://github.com/lessmilk/phaser-tutorials/raw/master/3-flappy_bird/flappy_bird_final.zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">tại đây</a>.</p>\n<h2 id=\"whats-next\" style=\"position:relative;\"><a href=\"#whats-next\" aria-label=\"whats next permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What’s next?</h2>\n<p>Chỉ với vài dòng code đơn giản bạn có thể tạo ra 1 game, nhưng bạn có thể làm tốt hơn nhiều cơ. Trong phần tiếp theo, cũng là phần cuối. Bạn có thể biết cách lưu điểm kỉ lục, màn hình start screen, menu… Bạn có thể subscribe để mình có thể email cho bạn khi phần tiếp theo hoàn thành. Chúc các bạn thành công.</p>","fields":{"slug":"/2014/03/huong-dan-viet-game-flappy-bird-bang.html","tagSlugs":["/tag/html-5/","/tag/post/","/tag/game/","/tag/tuts/"]},"frontmatter":{"date":"2014-03-07T16:59:00.000+07:00","description":"Trong phần 1 của chuỗi bài viết về cách viết 1 game Flappy Bird Clone, chúng ta đã làm được 1 bộ khung tương đối đơn giản, nhưng nó vẫn còn thiếu nhiều thứ. Trong phần 2 này chúng ta sẽ tìm hiểu cách thêm các hiệu ứng cho chú chim của chúng ta thêm phần ức chế.","tags":["html5","Post","game","tuts"],"title":"Hướng dẫn viết game Flappy Bird bằng HTML5 - Phần 2","fbCommentUrl":null}}},"pageContext":{"slug":"/2014/03/huong-dan-viet-game-flappy-bird-bang.html"}},"staticQueryHashes":["251939775","2672868365","401334301"]}